<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <title></title>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bb: 'var(--bg-color)',
                        dynamicBg: 'var(--bg-color)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        body {
            background-color: var(--bg-color);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            font-weight: 400;
            width: 700px;
        }

        h2 {
            font-size: 1.4em;
            font-weight: 700;
            margin: 10px 20px 10px;
            text-align: center;
        }
    </style>
    <style>
        :root {
            --bg-color: {{ background_color }};
        }
    </style>
</head>

<body>
    {% set bg_opacity_map = {
        'bf2042': 'bg-opacity-30',
        'bf6': 'bg-opacity-10',
    } %}
    {% set current_bg_opacity_class = bg_opacity_map.get(game, 'bg-opacity-10') %}
    {% set card_bg_color_map = {
        'bf2042': '30',
        'bf6': '20',
    } %}
    {% set current_card_bg_color = card_bg_color_map.get(game, 'gray-600') %}

    <div class="bg-cover relative" style="background-image: url('{{ banner }}'); height: 310px;">
        <div class="absolute inset-0 bg-gradient-to-b from-dynamicBg/0 via-dynamicBg/10 to-dynamicBg/40"></div>
        <div class="relative z-10 flex flex-col items-center justify-center pt-10 pb-10">
            <img src="{{ stat_entity.avatar }}" alt="avatar" class="rounded-lg w-32 h-32 object-cover border-2 border-gray-700" />
            <div class="font-bold text-4xl mt-2">{{ stat_entity.user_name }}</div>
            <div class="flex items-center font-semibold text-gray-200 mt-1">
                {% if game == 'bf6' %}
                <img src="{{ stat_entity.rank_img }}" width="25px" class="mr-1" alt="等级IMG"/>
                {% endif %}
                等级 {{ stat_entity.level }}
            </div>
            <div class="font-semibold text-gray-200 mt-1">游戏时间：{{ stat_entity.hours_played }}h</div>
        </div>
    </div>

    <h2 class="text-white">基本信息</h2>
    <div class="flex flex-row gap-4 justify-around flex-wrap mx-5 p-4 rounded-lg bg-gray-800 {{ current_bg_opacity_class }}">
        <div class="text-center p-4 rounded-lg bg-gray-600/{{current_card_bg_color}} w-32">
            {% if game == 'bf6' %}
                <div class="text-sm text-yellow-400">击杀玩家</div>
                <div class="text-2xl font-bold font-mono text-white">{{ stat_entity.player_kills }}</div>
                {% if stat_entity.player_kills_percentile < 30 %}
                <div class="text-xs text-green-400">Top {{stat_entity.player_kills_percentile}}%</div>
                {% elif stat_entity.player_kills_percentile < 60 %}
                <div class="text-xs text-gray-400">Top {{stat_entity.player_kills_percentile}}%</div>
                {% endif %}
            {% endif %}
            {% if game == 'bf2042' %}
                <div class="text-sm text-yellow-400">击杀</div>
                <div class="text-2xl font-bold font-mono text-white">{{ stat_entity.kills }}</div>
                {% if stat_entity.kills_percentile < 30 %}
                <div class="text-xs text-green-400">Top {{stat_entity.kills_percentile}}%</div>
                {% elif stat_entity.kills_percentile < 60 %}
                <div class="text-xs text-gray-400">Top {{stat_entity.kills_percentile}}%</div>
                {% endif %}
            {% endif %}
        </div>
        <div class="text-center p-4 rounded-lg bg-gray-600/{{current_card_bg_color}} w-32">
            <div class="text-sm text-yellow-400">对玩家K/D</div>
            <div class="text-2xl font-bold font-mono text-white">{{ stat_entity.human_kd_ratio }}</div>
            {% if stat_entity.human_kd_ratio_percentile < 30 %}
            <div class="text-xs text-green-400">Top {{ stat_entity.human_kd_ratio_percentile }}%</div>
            {% elif stat_entity.human_kd_ratio_percentile < 60 %}
            <div class="text-xs text-gray-400">Top {{ stat_entity.human_kd_ratio_percentile }}%</div>
            {% endif %}
        </div>
        <div class="text-center p-4 rounded-lg bg-gray-600/{{current_card_bg_color}} w-32">
            <div class="text-sm text-yellow-400">KPM</div>
            <div class="text-2xl font-bold font-mono text-white">{{ stat_entity.kills_per_minute }}</div>
            {% if stat_entity.kills_per_minute_percentile < 30 %}
            <div class="text-xs text-green-400">Top {{ stat_entity.kills_per_minute_percentile }}%</div>
            {% elif stat_entity.kills_per_minute_percentile < 60 %}
            <div class="text-xs text-gray-400">Top {{ stat_entity.kills_per_minute_percentile }}%</div>
            {% endif %}
        </div>
        <div class="text-center p-4 rounded-lg bg-gray-600/{{current_card_bg_color}} w-32">
            <div class="text-sm text-yellow-400">DPM</div>
            <div class="text-2xl font-bold font-mono text-white">{{ stat_entity.dmg_per_min }}</div>
            {% if stat_entity.dmg_per_min_percentile < 30 %}
            <div class="text-xs text-green-400">Top {{ stat_entity.dmg_per_min_percentile }}%</div>
            {% elif stat_entity.dmg_per_min_percentile < 60 %}
            <div class="text-xs text-gray-400">Top {{ stat_entity.dmg_per_min_percentile }}%</div>
            {% endif %}
        </div>
    </div>

    <div class="mb-4"></div>
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 mx-5 p-4 rounded-lg bg-gray-800 {{ current_bg_opacity_class }}">
        {% if game == 'bf6' %}
        <div class="text-center">
            <div class="text-sm text-yellow-400">总击杀</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.kills }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">总得分</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.score }}</div>
        </div>
        {% endif %}
        {% if game == 'bf2042' %}
        <div class="text-center">
            <div class="text-sm text-yellow-400">K/D</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.kill_death }}</div>
        </div>
        {% endif %}
        <div class="text-center">
            <div class="text-sm text-yellow-400">总伤害</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.damage_dealt }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">爆头率</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.headshot_percentage }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">助攻</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.assists }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">场均击杀</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.kills_per_match }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">急救</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.revives }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">胜率</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.wl_percentage }}</div>
        </div>
        {% if game == 'bf2042' %}
        <div class="text-center">
            <div class="text-sm text-yellow-400">场均伤害</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.damage_per_match }}</div>
        </div>
        {% endif %}
        <div class="text-center">
            <div class="text-sm text-yellow-400">死亡</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.deaths }}</div>
        </div>
        <div class="text-center">
            <div class="text-sm text-yellow-400">载具破坏</div>
            <div class="text-2xl font-bold font-mono">{{ stat_entity.vehicles_destroyed }}</div>
        </div>
    </div>

<!--    <h2 class="text-white">士兵信息</h2>-->
    <div class="mb-4"></div>
    <div class="flex flex-col gap-4 mx-5">
        {% from "soldier_card.html" import soldier_card %}
        {% if soldier_data is not none %}
        {% for soldier in soldier_data %}
        {{ soldier_card(soldier_entity=soldier, game=game, bg_opacity_class=current_bg_opacity_class) }}
        {% endfor %}
        {% else %}
        <div class="text-center text-slate-400 py-4">暂无载具数据</div>
        {% endif %}
        <div class="text-center text-slate-400 text-sm mt-1">
            使用
            <span class="text-cyan-300 font-mono">
                soldiers [玩家id],game={{ game }}
            </span>
            查看更多数据
        </div>
    </div>
    <h2 class="text-white">武器信息</h2>
    <div class="flex flex-col gap-4 mx-5">
        {% from "weapon_card.html" import weapon_card %}
        {% if weapon_data is not none %}
        {% for weapon in weapon_data %}
        {{ weapon_card(weapon_entity=weapon,game=game, bg_opacity_class=current_bg_opacity_class) }}
        {% endfor %}
        {% else %}
        <div class="text-center text-slate-400 py-4">暂无武器数据</div>
        {% endif %}
        <div class="text-center text-slate-400 text-sm mt-2">
            使用
            <span class="text-cyan-300 font-mono">
                weapons [玩家id],game={{ game }}
            </span>
            查看更多数据
        </div>
    </div>

    <h2 class="text-white">载具信息</h2>
    <div class="flex flex-col gap-4 mx-5">
        {% from "vehicle_card.html" import vehicle_card %}
        {% if vehicle_data is not none %}
        {% for vehicle in vehicle_data %}
        {{ vehicle_card(vehicle_entity=vehicle, game=game, bg_opacity_class=current_bg_opacity_class) }}
        {% endfor %}
        {% else %}
        <div class="text-center text-slate-400 py-4">暂无载具数据</div>
        {% endif %}
        <div class="text-center text-slate-400 text-sm mt-1">
            使用
            <span class="text-cyan-300 font-mono">
                vehicles [玩家id],game={{ game }}
            </span>
            查看更多数据
        </div>
    </div>


    <div class="flex flex-col justify-center items-center text-slate-400 py-3">
        <span>powered by astrbot</span>
        <span>数据更新时间：{{ update_time }}</span>
    </div>
</body>

</html>
